import{q as r,u as t,v as e,x as s}from"./index-69b6f7cc.js";const a=new class{constructor(){this.storageKey={orders:"app_orders",cart:"app_cart",userInfo:"app_user_info"}}saveOrders(t){try{const e={timestamp:Date.now(),data:t,version:"1.0"};return r(this.storageKey.orders,JSON.stringify(e)),r(this.storageKey.orders+"_backup",JSON.stringify(e)),!0}catch(e){return console.error("保存订单失败:",e),!1}}getOrders(){try{const r=t(this.storageKey.orders);if(r){return JSON.parse(r).data||[]}const e=t(this.storageKey.orders+"_backup");if(e){const r=JSON.parse(e);return this.saveOrders(r.data),r.data||[]}return[]}catch(r){console.error("获取订单失败:",r);try{const r=t(this.storageKey.orders+"_backup");if(r){return JSON.parse(r).data||[]}}catch(e){console.error("备份恢复也失败:",e)}return[]}}addOrder(r){const t=this.getOrders();return t.unshift(r),this.saveOrders(t)}updateOrder(r,t){const e=this.getOrders(),s=e.findIndex(t=>t.id===r);return s>-1&&(e[s]={...e[s],...t},this.saveOrders(e))}deleteOrder(r){const t=this.getOrders().filter(t=>t.id!==r);return this.saveOrders(t)}saveCart(t){try{return r(this.storageKey.cart,t),!0}catch(e){return console.error("保存购物车失败:",e),!1}}getCart(){try{return t(this.storageKey.cart)||[]}catch(r){return console.error("获取购物车失败:",r),[]}}clearCart(){try{return e(this.storageKey.cart),!0}catch(r){return console.error("清空购物车失败:",r),!1}}exportData(){try{const r={orders:this.getOrders(),cart:this.getCart(),exportTime:(new Date).toLocaleString(),version:"1.0"};return JSON.stringify(r,null,2)}catch(r){return console.error("导出数据失败:",r),null}}importData(r){try{const t=JSON.parse(r);return t.orders&&this.saveOrders(t.orders),t.cart&&this.saveCart(t.cart),!0}catch(t){return console.error("导入数据失败:",t),!1}}getStorageInfo(){try{const r=s();return{keys:r.keys,currentSize:r.currentSize,limitSize:r.limitSize,orders:this.getOrders().length,cart:this.getCart().length}}catch(r){return console.error("获取存储信息失败:",r),null}}};export{a as S};
